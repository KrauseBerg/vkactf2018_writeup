Роботы [Web 10]
================
> Роботы... Они повсюду.  
http://n****.ml:13375


Судя по названию очевидно, что нужно заглянуть в файл ```robots.txt```  
Переходим на: ```http://n****.ml:13375/robots.txt```  

Получаем флаг:  
> ```FLAG{sup3r_r0bo_fl4g}```



User-Name [Web 20]
================
> О нет, кажется, агентам сюда нельзя!   
http://n****.ml:13372

По названию можно понять, что решение связано с использованием ```user-agent```  
Попробуем зайти на сайт с пустым ```user-agent``` используя команду ```curl```:  

> ```$ curl -vv http://n****.ml:13372```

Получаем ответ:

> 
```html
<html>
        <head>
                <style>
                        #formchk{
                                margin-left: 0%;
                                margin-top: 2%;
                        }

                </style>
        </head>
        <body>

        <img src="/agent.jpg", width="100%", height="100%">

                FLAG{y0u_4r3_h4ck3rm4n}
        </body>
  ```
  
> ```FLAG{y0u_4r3_h4ck3rm4n}```
  
  
  
Строки [Web 30]
================
>Проверь, знаешь ли ты флаг.  
http://n****.ml:13373

К условию нам прилагается кусочек ```php``` кода:  
```php
<?php
   if(array_key_exists("chkflag",$_REQUEST)){
		if(!strcmp($_REQUEST["chkflag"],"[SECRET]")){
			echo "You are C00l H4cKER!!!!  ";
			echo "[SECRET]";
		}
		else{
			echo "<br>Wrong!<br>";
			}
	}	
?> 
```

За проверку флага отвечает функция ```strcmp```.  
Гуглим подробней про данную функцию.  

Например, я узнал, что...  
*Если вы полагаетесь на strcmp для безопасного сравнения строк, оба параметра должны быть строками, в противном случае результат крайне непредсказуем.*  
Example:  
```strcmp("foo", array()) => NULL + PHP Warning```  

Используем это в нашем таске.  
Для этого будем сравнивать нашу искомую строку с массивом  

Попробуем перейти на  
```http://n****.ml:13373/?chkflag[]```  
(```chkflag``` - это область для ввода текста. Ее название мы узнали из исходного кода ```<input name="chkflag">```)

Получаем флаг:

>You are C00l H4cKER!!!! ```FLAG{PHP_STRCMP_BUG}```


Ping [Web 30]
================
>А как вы защищаетесь от атак со стороны клиента?  
http://n****.ml:13374

Проходим по ссылке. Попробуй пропинговать любые ip адреса.  
Везде результат один и тот же. Это наталкивает на мысль, что команда ping работает некорректно.  

Я попробовал пропинговать свой VPS сервер. В это же время на VPS сервере работал tshark.  
Снифер не перехватил ни одного эхо-пакета, а значит команда ping на сайте - это всего лишь мираж.  

В строке ввода стоит регулярка, поэтому кроме как ip адреса мы ничего ввести не можем.  
Открываем исходный код страницы и удаляем регулярку ```pattern="(\d{1,3}\.){3}\d{1,3}"```

Можно догадаться, что когда мы пытаемся пропинговать ip адрес, вывод происходит с помощью команды echo.  
Используем это. Изначально удалив регулярку, отправим запрос ```; ls```  

>flag.php  
index.php

На сервере лежат 2 файла. Прочтем один из них  
```; cat flag.php```  
Обнаруживаем его пустым. Прочтем следующий файл:  
```; cat index.php```  
На выходе обнаруживаем флаг:  
> ```flag{$cmd}```

p.s. Также этот таск можно решить через Acunetix
